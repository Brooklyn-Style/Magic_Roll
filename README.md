# Magic Roll
Magic Roll is a handmade keyboard layout that minimizes outrolls and eliminates almost all SFBs through it's clever use of repeat and magic keys.

[Hyperroll](https://docs.google.com/document/d/1_a5Nzbkwyk1o0bvTctZrtgsee9jSP-6I0q3A0_9Mzm0/edit?tab=t.0#heading=h.an6umzmpc3dj "Hyperroll Keyboard Layout") and [Hieamtsrn](https://docs.google.com/document/d/1_a5Nzbkwyk1o0bvTctZrtgsee9jSP-6I0q3A0_9Mzm0/edit?tab=t.0#heading=h.ojttb28dodph "Hieamtsrn Keyboard Layout") inspired the name and alpha arrangement, while [Magic Sturdy](https://github.com/Ikcelaks/keyboard_layouts/blob/main/magic_sturdy/magic_sturdy.md "Magic Sturdy GitHub Page") and [Hands Down Neu](https://sites.google.com/alanreiser.com/handsdown/home/hands-down-neu "Hands Down Neu Website") inspired the use magic.
```
  j y o u '  b d l c p 
? h i e a .  g t s r n z
  x q _ @ ,  k m f w v
         ★  ␣ ☆

_ = Free Key (I have a layer key here)
@ = Repeat
★/☆ = Magic

J, H, X, Y, Q, B, G, M, F, C, P and Z are magic keys as well.
```
## Table of Contents:
- [Glossary](glossary.md)
- [Magic Functions](#magic-functions)
- [Stats](#stats)
- [Design](#design)
  - [Thumbs](#thumbs)
  - [Left Half](#left-half)
  - [Right Half](#right-half)
- [Tools Used](#tools-used)
---

<details>
  <summary><h2>Magic Functions:</h2></summary>

```
★:          ☆:          @ (Rep):      G:          J:          P:          Q:          X:
--------     --------    ---------     --------    --------    --------    --------    --------
★ → Shift   --------    THE@ → THEY   CG → CH     MJ → MM     BP → BV     @Q → @U     @X → @A
☆★ → ␣     ★☆ → U     ---------     PG → PH     RJ → RV     DP → DV     BQ → BM     BX → BR
.★ → ."     .☆ → ..                   SG → SC     SJ → SS                LQ → LF      CX → CR
,★ → ,"     --------    B:            TG → TC     TJ → TG                 WQ → WB     DX → DW
?★ → ?"     --------    --------      --------    WJ → WN                 XQ → XR     FX → FL
!★ → !"     --------    CB → CK                                                       GX → GR
@★ → @"     --------    SB → SW       M:                                              KX → KT
"★ → "A     --------    --------      --------                                        LX → LV
(★ → (A     --------                  FM → FL                                         MX → MB
A★ → AU     A☆ → A.     C:           --------                                         M☆X → MPR
B★ → BT     --------    --------                                                      PX → PR
--------    C☆ → CC     SC → SF       H:                                              RX → RP
--------    D☆ → DM     --------      --------                                        R☆X → RCL
E★ → EO     E☆ → EY                  BH → BL                                         SX → SP 
--------    F☆ → FL     F:            DH → DR                                         TX → TW 
--------    G☆ → GM     -------       FH → FR                                         WX → WR 
H★ → H?     H☆ → HH     VF → VL      GH → GL                                         -------- 
I★ → IQ     I☆ → IY     WF → WL      KH → KN                                          
--------    J☆ → JO                   LH → LL                                         Y:
K★ → KG     --------                  MH → MP                                         --------
L★ → LS     L☆ → LS                  M☆H → MPL                                       JY → JI
M★ → MP     M☆ → MP                  RH → RR                                         --------
N★ → NP     N☆ → NV                                                                   
O★ → OE     O☆ → OX                                                                   Z:
P★ → PV     P☆ → PN                                                                   --------
Q★ → QI     Q☆ → QU                                                                   DZ → DT
R★ → RC     R☆ → RC                                                                   GZ → GT
--------    S☆ → SL                                                                    LZ → LW 
--------    T☆ → TR                                                                    MZ → MT 
U★ → UA     U☆ → U,                                                                   RZ → RW
V★ → VP     V☆ → VV                                                                   TZ → TM
X★ → XI     X☆ → XH                                                                   
Y★ → YI                                                                        
YEA★ → YEAH
YOU★ → YOU'
THE@★ → THEY'
```
</details>

---
<details>
  <summary><h2>Stats:</h2></summary>
Without repeat or magic unless specified.

**[Layout Playground](https://oxey.dev/playground/index.html "Layout Playground"):**
![without repeat](images/without%20repeat.jpg)
**[Layout Playground](https://oxey.dev/playground/index.html "Layout Playground")** (With Repeat):
![repeat](images/repeat.jpg)
**[Cyanophage](https://cyanophage.github.io/playground.html?layout=jyou%27bdlcp-hiea.gtsrnzxq%5C%3D%2Ckmfwv%2F%3B&mode=ergo&lan=english "View on Cyanophage"):**
![cyanophage](images/cyanophage.jpg)
**[KeySolve](https://drowningnewt.github.io/keysolve-web "Keysolve"):**
![keysolve](images/keysolve.jpg)

</details>

---

## Design:
#### <ins>*Thumbs:*
Each thumb has a magic key that's used to eliminate most SFBs and make certain patterns more comfortable. The outputs are 1:1 to make them more like normal keys and less like macros. This makes using them simpler and ensures that you won't get banned from typing websites either.

In general, if the previous key was on the same hand, the output will be the key above or below it. *E.g. `E★` → `EO` `O★` → `OE`*

If the previous key was on the opposite hand, the output will fix an awkward pattern, uncommon SFB, or even the same SFB if it's at the end of a word. *E.g. `Q☆` → `QU` `L★` → `LS`*. `☆ → Space` SFBs can be avoided this way.

#### <ins>*Left Half:*
The pinky `H` + `IEA`/`YOU` setup is used for it's insane 83:1 inroll ratio. `J`, `X`, and `Q` then complete the pinky and ring columns, with punctuation being placed on the inner index for low SFBs. 

`X` almost never comes after a consonant so it turns consonant-hand outrolls into alternates. They then become inrolls when a vowel follows. *E.g. `BX` → `BR` (+ `AEIOU`)*

`H` does the same thing, just to a lesser extent since it *does* pair with most of the other consonants.

`Repeat` was put on the index since I didn't have a free thumb key and wasn't willing to give up magic. This placement doesn't really cause any problems though, as the new SFBs are pretty infequent and can be fixed with magic or alt-fingering. 

Additionally, this key has a few exceptions:
- `H@` → `HT`. `HH` is extremely uncommon so this makes `HT` a roll instead.
- `Q@` → `QU`. `QQ` doesn't occur in any word and since `U` is two rows above `Q`, it becomes more comfortable to type.
- `Backspace` after repeats or if more than 400ms has passed since the last keypress. This gets backspace off the pinky and brings up the index's usage.

#### <ins>*Right Half:*
Almost all of the consonants have been placed on this side to minimize one-handed strings, outrolls, and redirects, with the top row being preferred to keep scissors low. Magic is then used to mitigate the remaining uncomfortable 2U row jumps.

`N` is similar to `H` in that it usually comes before a consonant so it goes on the pinky. The rest of the letters aren't nearly as unidirectional but even so, they've been arranged for inrolls.

The `BGK` inner index column puts `NG` on the home row and `BL` on the same row. It also achieves the lowest "word effort" on the Cyanophage analyzer compared to other arrangements. Even though this placement *does* lose some inrolls, it's better than putting it on the pinky with `P` and `N`.

`D` on the top row makes it + `B`, `G`, and `K` easily alt-fingerable. `M` pairs nicely with the other index letters in terms of SFBs once `MB`/`BM` gets fixed with magic.

The `LSF` and `CRW` columns are a little questionable but with all the consonants on this side, there weren't many other options. You could swap `L` and `C` for marginally better stats, but then you'd lose the `CL` and `RLD` inrolls, and make `NCL` a redirect, which might not be worth it.

The `PNV` column, while good if it was on any other finger, isn't great on the pinky. The SFBs are low but it's usage is relatively high. The SFSs are also quite bothersome so swapping `P` with `K` or `B` could be a potential solution.

## Tools Used:
- The [Keyboard Layouts Google Doc](https://docs.google.com/document/d/1W0jhfqJI2ueJ2FNseR4YAFpNfsUM-_FlREHbpNGmC2o "Keyboard Layouts Google Doc") for design knowledge
- The [Layout Playground](https://oxey.dev/playground/index.html "Layout Playground") analyzer for drag and drop letter swaps and their resulting stats
- The [Cyanophage](https://cyanophage.github.io "Cyanophage Analyzer") analyzer for more stats
- [MonkeyType's](https://monkeytype.com "MonkeyType") word filter for specific bigram and trigram frequencies
- [AutoHotkey](https://www.autohotkey.com "AutoHotkey's Website") to handle repeat and magic functions, since I couldn't be bothered to implement them with [QMK](https://docs.qmk.fm/features/repeat_key "QMK Repeat/Magic Documentation")

### Typing Test:
![typing test](images/typing%20test.jpg)
